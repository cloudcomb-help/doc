# 管理存储空间

## 概览

如下图所示，点击左侧边栏“对象存储”进入概览页。

![](../image/201608161401.jpg)

## 创建桶

* 填写桶名称：桶名称不可与已有桶重名
* 选择地域：目前只支持杭州区域，后续会提供更多的区域以供选择
* 选择读写权限
	* 私有:读写桶内资源需要通过认证
	* 公开:所有人均可访问该桶资源，但是写数据仍然需要通过认证
* 完成创建：点击立即创建即可完成桶创建

![](../image/201608051449.jpg)

## 桶属性

### 读权限 ( ACL ) 设置
在概览页点击桶进入桶详情页

![](../image/201608161403.jpg)

在上图中点击“桶属性”进入桶属性页，默认进入读权限设置。 在本页中可以变更桶的读权限，变更后点击“提交修改”完成配置。

![](../image/201608161404.jpg)

### Logging 设置
Logging 功能默认关闭，可以选择开启，开启后，日志文件将以小时粒度存储。

1. 开启后可以选择日志存储位置，日志必须存储在一个已经存在的桶中，可以选择现有桶或者创建一个新的桶

2. 填写日志文件的前缀，每小时的日志文件都将以此前缀为对象名的起始。

3. 点击“提交修改”完成配置

![](../image/201608161405.jpg)

### Website 设置
NOS 支持静态网站托管。用户可以将自己的存储空间配置成静态网站模式。 为了使用户更方便地管理在 NOS 上托管的静态网站，NOS 支持两种模式：

1. 默认首页支持，NOS 默认将 index.html 作为桶空间的首页，目前不支持自定义设置首页。

2. 默认 404 页支持，通过指定错误页面，你可以为你的用户提供恰当的出错提示，同时也支持默认 404 页。

3. 点击“提交修改”完成配置

![](../image/201608161406.jpg)

### 防盗链设置
为了防止用户在 NOS 上的公开数据资源被其他人盗链，NOS 支持基于 HTTP header 中表头字段 referer 的防盗链方法。 如下图所示，可以对一个桶设置 referer 字段的白名单和是否允许 referer 字段为空的请求访问。 例如，对于一个名为 test1 的 bucket，设置其 referer 白名单为 www.163.com 和 www.baidu.com 并且设置 Referer 不允许为空。 则所有 referer 为 www.163.com 或者 www.baidu.com 的请求才能访问 test1 这个桶中的 object 。 填写信息后点击“提交修改”完成配置

![](../image/201608161407.jpg)

### 自定义域名

您在 NOS 桶上传对象后，可获取的对象地址包含两个部分：NOS 域名地址加对象文件名。如：`http://nostest123456.nos-eastchina1.126.net/1.jpg` 为了避免业务中方便使用，建议您使用自定义域名方式访问 NOS。 每个空间都可以绑定一个或多个自定义域名，以便于更方便的访问资源。 自定义域名绑定成功后，为了使用域名正常访问 NOS，还需要添加 CNAME 记录指向NOS桶对应的域名。

例如 `1.jpg` 存放于名为 nostest123456 的 NOS 桶中，并将该 NOS 桶绑定到一个二级域名 `jpg.163.com`，那么如果要在一个 HTML 页面中引用该桶的 1.jpg 资源，大概的写法如下：

	<img source=”http://jpg.163.com/1.jpg“></img>

这样一定程度上隐藏了正在使用 NOS 的事实，更大的好处是如果需要从一个云存储迁移到另一个云存储，只需要修改域名 DNS 的 CNAME 设置，而无需更新网页源代码。

![](../image/管理存储空间-自定义域名.PNG)

如上图所示，在桶属性页中，点击「自定义域名」，进入自定义域名页。点击「添加域名」后弹出下图所示窗口，在此窗口填写自定义域名，确认后添加操作提交成功并返回。

![](../image/管理存储空间-添加自定义域名.PNG)

创建返回后，后台会对自定义域名的 ICP 备案信息进行查询，需要一段时间，这段时间域名状态为「审核中」，如下图所示。当域名状态转换为「审核完成」时，自定义域名生效。

![](../image/管理存储空间-自定义域名列表.PNG)

在自定义域名列表中，在所在域名行点击删除，可对删除已配置的自定义域名，删除自定义域名需要经过安全验证。

### 跨域设置

跨域访问，或者说 JavaScript 的跨域访问问题，是浏览器出于安全考虑而设置的一个限制，即同源策略。举例说明，当 A，B 两个网站属于不同的域时，如果来自于 A 网站的页面中的 JavaScript 代码希望访问 B 网站的时候，浏览器会拒绝该访问。

然而，在实际应用中，经常会有跨域访问的需求。比如用户的网站 www.a.com，后端使用了 NOS，在网页中提供了使用 JavaScript 实现的上传功能，但是在该页面中，只能向 www.a.com 发送请求，向其他网站发送的请求都会被浏览器拒绝。这样会导致用户上传的数据必须从 www.a.com 中转。如果设置了跨域访问的话，用户就可以直接上传到 NOS 而无需从 www.a.com 中转。

跨域资源共享（Cross-Origin Resource Sharing，简称 CORS），是 HTML5 提供的标准跨域解决方案，具体的 CORS 规则可以参考 [W3C CORS 规范](http://www.w3.org/TR/cors/)。

![](../image/管理存储空间-跨域设置.PNG)

如上图所示，在桶属性页中，点击「跨域设置」，进入跨域设置页。为支持大部分跨域请求，系统默认添加了一条支持 GET 和 POST 的跨域设置。 点击「 添加规则」后弹出下图所示窗口，在此窗口根据提示填写来源，复选框勾选 Method，填写 Allow Header、Expose Header、缓存时间（其中带*的为必选项），确认点击提交。

![](../image/管理存储空间-跨域设置添加规则.PNG)

## 删除桶

只有桶内没有数据时，才能被删除。 在桶所在行点击删除，按照提示进行二次确认和安全验证可将桶删除。

![](../image/2016080514527.jpg)

![](../image/201608051458.jpg)

![](../image/201608051459.jpg)