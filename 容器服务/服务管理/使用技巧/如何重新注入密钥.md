# 如何重新注入密钥

目前我们提供两种方式管理容器内的密钥：

* 自主管理（创建服务时，不在控制台注入密钥）<br>所有密钥由你自主管理，创建完成后支持重新注入密钥。
* 蜂巢托管（创建服务时，在控制台注入密钥）<br>所有密钥由蜂巢托管，创建完成后不支持重新注入密钥（未来我们将提供控制台层的密钥管理功能）。

<span>Attention:</span><div class="alertContent">若在创建服务时，选择了注入密钥则以下操作都不支持。![](../image/如何重新注入密钥-选择注入密钥.png)</div>

## 一、重新生成密钥

<span>Note:</span><div class="alertContent">若没有密钥，可以使用以下方法在容器内生成新的密钥对，然后将私钥拷贝到本地使用。</div>

1、打开 Web Console（[如何使用蜂巢 WebConsole](http://support.c.163.com/md.html#!容器服务/服务管理/使用技巧/如何使用蜂巢WebConsole.md)），输入以下命令生成新密钥对：

	ssh-keygen

2、生成过程中的人工交互部分，默认全部回车即可，生成完毕输入以下命令将公钥导入授权文件：
	
	cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys

3、输入以下命令输出「私钥内容」，并将输出内容复制或下载到本地，保存为任意文件名。

<span>Attention:</span><div class="alertContent">复制后注意删除多余空格和换行符。</div>

	cat ~/.ssh/id_rsa

![](../image/如何使用SSH密钥登录-重新注入密钥.png)

4、在原生 SHH 客户端导入该私钥即可使用，详见：[如何使用 SSH 密钥登录](http://support.c.163.com/md.html#!容器服务/服务管理/使用技巧/如何使用 SSH 密钥登录.md)。


## 二、添加公钥

<span>Note:</span><div class="alertContent">若本地已有可用密钥对，可以使用以下方法，将公钥添加至容器中。</div>

1、打开 Web Console（[如何使用蜂巢 WebConsole](http://support.c.163.com/md.html#!容器服务/服务管理/使用技巧/如何使用蜂巢WebConsole.md)），输入以下命令创建 .ssh 文件夹并调整权限：

	mdkir ~/.ssh
	chmod 700 ~/.ssh

2、输入以下命令将本地公钥内容（.pub 文件）导入授权文件：

	echo "此处填写你的公钥内容" >> ~/.ssh/authorized_keys

3、调整权限：

	chmod 600 ~/.ssh/authorized_keys

![](../image/如何重新注入密钥-添加公钥.png)

4、在原生 SHH 客户端导入本地私钥即可使用，详见：[如何使用 SSH 密钥登录](http://support.c.163.com/md.html#!容器服务/服务管理/使用技巧/如何使用 SSH 密钥登录.md)。










